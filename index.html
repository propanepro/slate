
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#engage-brandcraft" class="toc-h1 toc-link" data-title="Engage/Brandcraft">Engage/Brandcraft</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-quote" class="toc-h2 toc-link" data-title="Engage/Brandcraft">Get quote</a>
                  </li>
                  <li>
                    <a href="#create-an-applicant" class="toc-h2 toc-link" data-title="Engage/Brandcraft">Create an applicant</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#other-endpoints" class="toc-h1 toc-link" data-title="Other Endpoints">Other Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#status" class="toc-h2 toc-link" data-title="Other Endpoints">Status</a>
                  </li>
                  <li>
                    <a href="#tf-crm" class="toc-h2 toc-link" data-title="Other Endpoints">TF-CRM</a>
                  </li>
                  <li>
                    <a href="#propane-pro" class="toc-h2 toc-link" data-title="Other Endpoints">Propane.pro</a>
                  </li>
                  <li>
                    <a href="#webhooks" class="toc-h2 toc-link" data-title="Other Endpoints">Webhooks</a>
                  </li>
                  <li>
                    <a href="#engage-brandcraft-2" class="toc-h2 toc-link" data-title="Other Endpoints">Engage/Brandcraft</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/tripit/slate'>Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Tankfarm API (TF-api). You can use our API to access Tankfarm endpoints.</p>
<h1 id='authentication'>Authentication</h1>
<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># pass the correct header with each request</span>
curl <span class="s2">"api_endpoint_here"</span>
  -H <span class="s2">"Authorization: Token token=stage_123"</span>
</code></pre>
<blockquote>
<p>Make sure to replace <code>stage_123</code> with your API key.</p>
</blockquote>

<p>TF-api uses API keys to allow access to the API. You can request an API
key from daniel@tankfarmgroup.com.</p>

<p>TF-api expects the API key to be included in all API requests to the server in
a header that looks like the following:</p>

<p><code>Authorization: Token token=stage_123</code></p>

<aside class="notice">
You must replace <code>stage_123</code> with your personal API key.
</aside>
<h1 id='engage-brandcraft'>Engage/Brandcraft</h1><h2 id='get-quote'>Get quote</h2>
<blockquote>
<p>To get a quote, use this code:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://some_url.com/api/v1/quotes"</span>
-H <span class="s2">"Authorization: Token token=stage_123"</span>
--data <span class="s1">'{"zipcode": "11001", "annual_usage": 100, "owns_tank": true}'</span>
--header <span class="s1">'content-type: application/json'</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"quotes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="s2">"/api/v1/quotes/"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"zipcode"</span><span class="p">:</span><span class="s2">"11001"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"annual-usage"</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="s2">"owns-tank"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"price"</span><span class="p">:</span><span class="s2">"3.9717"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"Floral Park"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"NY"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"supplier-name"</span><span class="p">:</span><span class="s2">"ABC Propane"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"supplier-description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your wonderful supplier."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves quotes.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://some_url.com/api/v1/quotes</code></p>
<h3 id='request-body-parameters'>Request body parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>zipcode</td>
<td>String</td>
<td>Five digit US postal ZIP code.</td>
</tr>
<tr>
<td>annual_usage</td>
<td>Integer</td>
<td>Gallons of propane used per year.</td>
</tr>
<tr>
<td>owns_tank</td>
<td>Boolean</td>
<td>Does applicant own their propane tank?</td>
</tr>
</tbody></table>

<aside class="notice">
For this particular request body parameters use underscores while the returned JSON
uses dashes.
</aside>
<h2 id='create-an-applicant'>Create an applicant</h2><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://some_url.com/api/v1/engage-leads"</span>
-H <span class="s2">"Authorization: Token token=stage_123"</span>
--data
  <span class="s1">'{
    "data": {
      "type": "engage-leads",
      "attributes": {
        "name": "Mars Rover",
        "email": "msrover9a@test.com",
        "address": "123 Somewhere",
        "city": "Assonet",
        "state": "MA",
        "zipcode": "02702",
        "phone": "(888) 555-1212",
        "metadata": {
          "propane_use": ["primary_heat-medium", "hot_water", "cooking_range"],
          "owns_tank": true,
          "annual_usage": 500,
          "underground_tank": false,
          "tank_count": 2,
          "total_tank_size": 700,
          "previous_supplier": "prev sup",
          "quote": {
            "ppg": 2.18,
            "supplier_name": "ABC Supplier"
          }
        }
      }
    }
  }'</span>
--header <span class="s1">'content-type: application/vnd.api+json'</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"147953"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"engage-leads"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="s2">"http://some_url.com/api/v1/engage-leads/147953"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Mars Rover"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"msrover9a@test.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="s2">"123 Somewhere"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"Assonet"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"MA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"zipcode"</span><span class="p">:</span><span class="s2">"02702"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone"</span><span class="p">:</span><span class="s2">"(888) 555-1212"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"metadata"</span><span class="p">:{</span><span class="w">
        </span><span class="s2">"propane_use"</span><span class="p">:[</span><span class="s2">"primary_heat-medium"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hot_water"</span><span class="p">,</span><span class="s2">"cooking_range"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"owns_tank"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"annual_usage"</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span><span class="w">
        </span><span class="s2">"underground_tank"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"tank_count"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"total_tank_size"</span><span class="p">:</span><span class="mi">700</span><span class="p">,</span><span class="w">
        </span><span class="s2">"previous_supplier"</span><span class="p">:</span><span class="s2">"prev sup"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"quote"</span><span class="p">:[{</span><span class="s2">"ppg"</span><span class="p">:</span><span class="mf">2.18</span><span class="p">,</span><span class="s2">"supplier_name"</span><span class="p">:</span><span class="s2">"ABC Supplier"</span><span class="p">,</span><span class="s2">"created_at"</span><span class="p">:</span><span class="s2">"2017-08-02T08:26:19.360-07:00"</span><span class="p">}]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint creates a new user/applicant. Used when applicant signs up on tankfarmgroup.com website.</p>

<aside class="notice">
Content-type must be <code>application/vnd.api+json</code>
</aside>

<aside class="warning">
Dupe emails will cause an error but it will update some information on the user about the dupe submit attempt.
It also records all the form data submitted for each dupe request.
</aside>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>POST curl &quot;https://some_url.com/api/v1/engage-leads</code></p>
<h3 id='request-body-parameters-top-level'>Request body parameters (top level)</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>data</td>
<td>json</td>
<td>Contains <code>type</code> and <code>attributes</code> keys</td>
</tr>
</tbody></table>
<h3 id='request-body-parameters-data'>Request body parameters (data)</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string</td>
<td><code>engage-leads</code></td>
</tr>
<tr>
<td>attributes</td>
<td>json</td>
<td>User data to populate</td>
</tr>
</tbody></table>
<h3 id='request-body-parameters-data-attributes'>Request body parameters (data/attributes)</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Integer</td>
<td>Applicants full name</td>
</tr>
<tr>
<td>email</td>
<td>Boolean</td>
<td></td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>state</td>
<td>String</td>
<td>Two digit state code</td>
</tr>
<tr>
<td>zipcode</td>
<td>String</td>
<td>Five digit ZIP code</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>metadata</td>
<td>json</td>
<td>User related metadata - mostly propane related.</td>
</tr>
</tbody></table>
<h3 id='request-body-parameters-data-attributes-metadata'>Request body parameters (data/attributes/metadata)</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>propane_use</td>
<td>Array</td>
<td>e.g. primary_head-medium, hot_water, etc</td>
</tr>
<tr>
<td>owns_tank</td>
<td>Boolean</td>
<td>true or false</td>
</tr>
<tr>
<td>annual_usage</td>
<td>Integer</td>
<td>amount of propane used per year</td>
</tr>
<tr>
<td>underground_tank</td>
<td>Boolean</td>
<td>true (yes underground) or false (above ground)</td>
</tr>
<tr>
<td>tank_count</td>
<td>Integer</td>
<td>number of propane tanks</td>
</tr>
<tr>
<td>total_tank_size</td>
<td>Integer</td>
<td>sum of propane tank gallons</td>
</tr>
<tr>
<td>previous_supplier</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>quote</td>
<td>json</td>
<td>quote provided by Tankfarm</td>
</tr>
</tbody></table>
<h3 id='request-body-parameters-data-attributes-metadata-quote'>Request body parameters (data/attributes/metadata/quote)</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ppg</td>
<td>decimal</td>
<td>quoted price per gallon</td>
</tr>
<tr>
<td>supplier_name</td>
<td>string</td>
<td>named of matched supplier</td>
</tr>
</tbody></table>
<h1 id='other-endpoints'>Other Endpoints</h1>
<p>Just a list of endpoints we want to keep track of.</p>
<h2 id='status'>Status</h2>
<table><thead>
<tr>
<th>Type</th>
<th>Action/Controller</th>
</tr>
</thead><tbody>
<tr>
<td>GET &quot;/&quot;</td>
<td>PagesController#status</td>
</tr>
</tbody></table>
<h2 id='tf-crm'>TF-CRM</h2>
<table><thead>
<tr>
<th>Type</th>
<th>Action/Controller</th>
</tr>
</thead><tbody>
<tr>
<td>POST &quot;/api/v1/users&quot;</td>
<td>Api::V1::UsersController#update</td>
</tr>
<tr>
<td>PUT &quot;/api/v1/users/61603?include=signup-by&amp;context_current_user_id=135947&quot;</td>
<td>Api::V1::UsersController#update</td>
</tr>
</tbody></table>
<h2 id='propane-pro'>Propane.pro</h2>
<table><thead>
<tr>
<th>Type</th>
<th>Action/Controller</th>
</tr>
</thead><tbody>
<tr>
<td>POST &quot;/api/v1/pp-leads&quot;</td>
<td>Api::V1::PpLeadsController#create</td>
</tr>
</tbody></table>
<h2 id='webhooks'>Webhooks</h2>
<table><thead>
<tr>
<th>Type</th>
<th>Action/Controller</th>
</tr>
</thead><tbody>
<tr>
<td>POST &quot;/api/v1/sendinblue_webhook&quot;</td>
<td>Api::V1::WebhooksController#sendinblue</td>
</tr>
<tr>
<td>POST &quot;/api/v1/opt_out_webhook&quot;</td>
<td>Api::V1::WebhooksController#opt_out</td>
</tr>
<tr>
<td>POST &quot;/api/v1/dial_call_status_webhook/25578&quot;</td>
<td>Api::V1::WebhooksController#dialCallStatus</td>
</tr>
</tbody></table>
<h2 id='engage-brandcraft-2'>Engage/Brandcraft</h2>
<p>See Engage/Brandcraft section</p>
<h1 id='errors'>Errors</h1>
<p>TF-api uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request didn&#39;t work.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- You don&#39;t have access.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified resource could not be found.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
